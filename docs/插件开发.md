# ğŸ§©æ’ä»¶å¼€å‘ğŸ§©
## æ·±å…¥äº†è§£
Re-SimpQä¼šåœ¨å¯åŠ¨æ¡†æ¶åï¼Œä½¿ç”¨è¿è¡Œä½äº /plugins æ–‡ä»¶å¤¹æ‰€æœ‰Pythonæ–‡ä»¶  
ç„¶åæ’ä»¶å°†è‡ªå·±å¯¹åº”äº‹ä»¶çš„å‡½æ•°æ³¨å†Œåˆ°Re-SimpQä¸­ï¼Œä¾›é€‚é…å™¨è°ƒç”¨

## è§„èŒƒæ’ä»¶
æˆ‘ä»¬æ¨èæ’ä»¶ä½œè€…åœ¨æ’ä»¶ä¸­æ·»åŠ  ***PLUGINFO*** ä»¥æ ‡æ˜æ’ä»¶ä¿¡æ¯
```python
PLUGINFO={
    "name":"æ’ä»¶åç§°",
    "version":"ç‰ˆæœ¬",
    "author":"ä½œè€…",
    # ä»¥ä¸Šä¸ºåŸºæœ¬çš„ä¿¡æ¯ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ‰©å±•
}
```

## è¿ˆå‡ºç¬¬ä¸€æ­¥
libs/loaderæ˜¯Re-SimpQæ’ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œæä¾›äº†äº‹ä»¶æ³¨å†Œå™¨å’Œäº‹ä»¶è°ƒç”¨å™¨å‡½æ•°åŠŸèƒ½
### äº‹ä»¶æ³¨å†Œå™¨ *regEvent(event,func)*
  
eventå‚æ•°å¡«å…¥éœ€è¦æ³¨å†Œçš„äº‹ä»¶  
funcå‡½æ•°å¡«å…¥äº‹ä»¶å›è°ƒå‡½æ•°  

> ä»¥ä¸‹ä¸ºæ’ä»¶åˆå§‹åŒ–æ—¶ç¤ºä¾‹
```python
from libs import loader
def init(log,dat,bot):
    log.info("æ’ä»¶æ­£åœ¨åˆå§‹åŒ–")
loader.regEvent("init",init)
```
**å›ä¼ çš„ä¸€äº›å‚æ•°**
+ logä¸ºæ¡†æ¶ä¸ºæ’ä»¶æ³¨å†Œçš„æ—¥å¿—å™¨  
+ datä¸ºäº‹ä»¶å›ä¼ çš„æ•°æ®  
+ botä¸ºOnebotæ³¨å†Œçš„API

**æ¡†æ¶è‡ªå¸¦çš„ä¸€äº›äº‹ä»¶**
- *init* é©±åŠ¨å™¨å¯åŠ¨æ—¶
- *close* websocketé©±åŠ¨å™¨æ–­å¼€æ—¶
- *user_input* å½“ç”¨æˆ·è¾“å…¥å‘½ä»¤
- *listen_events* ç›‘å¬æ‰€æœ‰äº‹ä»¶ï¼Œä¼˜å…ˆçº§æœ€é«˜

**Onebotçš„æ¶ˆæ¯äº‹ä»¶**  
æ‰€æœ‰ä¸ŠæŠ¥éƒ½ä¼šåŒ…å«é€šç”¨æ•°æ® >> [ä¼ é€é—¨](https://docs.go-cqhttp.org/event/#%E9%80%9A%E7%94%A8%E6%95%B0%E6%8D%AE)  
- *message* æˆ– *message_sent* æ¶ˆæ¯ä¸ŠæŠ¥ >> [è¿”å›å‚æ•°](https://docs.go-cqhttp.org/event/#%E6%B6%88%E6%81%AF%E4%B8%8A%E6%8A%A5)  
- *notice* é€šçŸ¥ä¸ŠæŠ¥ >> [è¿”å›å‚æ•°](https://docs.go-cqhttp.org/event/#%E9%80%9A%E7%9F%A5%E4%B8%8A%E6%8A%A5)  
- *request* è¯·æ±‚ä¸ŠæŠ¥ >> [è¿”å›å‚æ•°](https://docs.go-cqhttp.org/event/#%E9%80%9A%E7%9F%A5%E4%B8%8A%E6%8A%A5)
- ~~*meta_event* å¿ƒè·³ä¸ŠæŠ¥ å·²è¢«æ¡†æ¶è¿‡æ»¤~~  

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä½ æƒ³è¦çš„äº‹ä»¶ >> [æ•°æ®å®šä¹‰](https://docs.go-cqhttp.org/event/#%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89)

### äº‹ä»¶è°ƒç”¨å™¨ *callPlugins(event,dat)*

eventå¡«å…¥éœ€è¦è°ƒç”¨çš„äº‹ä»¶  
datå¡«å…¥éœ€è¦å›ä¼ çš„æ•°æ®  

> ä»¥ä¸‹ä¸ºç®€å•çš„å°ç¤ºä¾‹
```python
# Plugin 1
from libs import loader
def message(log,dat,bot):
    message = dat["raw_message"] # è·å–åŸå§‹æ¶ˆæ¯
    user_id = dat["user_id"] # è·å–ç”¨æˆ·QQå·
    if message.find("Hello"): # å½“æ¶ˆæ¯ä¸­å«æœ‰ <Hello> æ—¶
        # æ³¨å†Œ <Say_Hello> äº‹ä»¶å¹¶ä¼ å…¥ç”¨æˆ·QQå·
        loader.callPlugins("Say_Hello",{"user_id":user_id})
```
```python
# Plugin 2
from libs import loader
def listen_Hello(log,dat,bot):
    log.info("%s è¯´äº†Hello!"%dat["user_id"])
loader.regEvent("Say_Hello",listen_Hello) # æ³¨å†ŒSay_Helloäº‹ä»¶å›è°ƒå™¨
```
å½“ç”¨æˆ·å‘é€æ¶ˆæ¯ä¸­å«æœ‰Hello  
åˆ™æ‰“å°è°è¯´äº†Hello!

### å°æŠ€å·§

**loader.plugins ä¿å­˜äº†æ‰€æœ‰çš„äº‹ä»¶å’Œå¯¹åº”çš„å›è°ƒå‡½æ•°**   
regEventæ³¨å†Œäº‹ä»¶æ—¶ä¼šå°†å‡½æ•°çš„äº‹ä»¶åˆ›å»ºä¸€ä¸ªåˆ—è¡¨æ”¾åœ¨pluginsä¸­  
> pluginsçš„æ•°æ®ç»“æ„
```python
plugins={
    "äº‹ä»¶1":[
        {"name":"æ’ä»¶1åç§°","func":"æ’ä»¶1å›è°ƒå‡½æ•°"}
    ]
}
```

**loader.unloads ä¸­çš„æ’ä»¶ä¸ä¼šè¢«åŠ è½½å™¨è¿è¡Œ**  
å°†æ’ä»¶åç§°appendåˆ°unloadsåˆ—è¡¨ä¸­ï¼Œåˆ™è¿è¡Œæ’ä»¶æ—¶è·³è¿‡æ­¤æ’ä»¶

## è¯·æ±‚æ¥å£
Re-SimpQæ”¯æŒ Onebot æ‰€æœ‰çš„æ¥å£  
è°ƒç”¨æ—¶å‚æ•°æŒ‰ç…§æ–‡æ¡£ä¸­å‚æ•°çš„é¡ºåºæ’åˆ—
- Napcat API [ä¼ é€é—¨](https://apifox.com/apidoc/shared-c3bab595-b4a3-429b-a873-cbbe6b9a1f6a)  
- go-cqhttp API [ä¼ é€é—¨](https://docs.go-cqhttp.org/api)  
- Lagrange.Onebot API [ä¼ é€é—¨](https://lagrangedev.github.io/Lagrange.Doc/Lagrange.OneBot/API/Extend/)
- Onebot v11 API [ä¼ é€é—¨](https://github.com/botuniverse/onebot-11/blob/master/api/public.md)  
*æ¡†æ¶å†…ç½®å‡½æ•°ä»åœ¨å¼€å‘ä¸­*

**ä½¿ç”¨[CQç ](https://docs.go-cqhttp.org/cqcode)è®©ä½ çš„æ¶ˆæ¯æ›´ä¸°å¯Œ**

## loggeræ—¥å¿—å™¨
æ³¨å†Œäº‹ä»¶æ—¶æ¡†æ¶å·²è‡ªåŠ¨å¸®ä½ æ³¨å†Œå¥½äº†æ—¥å¿—å™¨  
æ­¤ä¸»é¢˜ä¸ºæ—¥å¿—å™¨çš„æ‹“å±•  

ä¸€ä¸ªç®€å•çš„æ³¨å†Œæ—¥å¿—å™¨å®ä¾‹
```python
from libs import logger
log=logger.getLogger("Main")
log.info("Hello World!")
```

è°ƒæ•´æ—¥å¿—å™¨çš„ä¸€äº›è®¾ç½® >> [ä¼ é€é—¨](/æ¡†æ¶è®¾ç½®.md#logger-å¼€æ”¾æ¥å£)

## æ¡†æ¶å¼€æ”¾æ¥å£
> è¯¦è§[æ¡†æ¶è®¾ç½®](/æ¡†æ¶è®¾ç½®.md)

## ä¸€äº›ç¤ºä¾‹
```python
from libs import loader
def message(log,dat,bot):
    sub_type = dat["message_type"]
    if sub_type == "group":
        group_id = dat["group_id"]
        user_id = dat["user_id"]
        message = dat["raw_message"]
        if message=="Hello":
            bot.send_group_msg(group_id,f"[CQ=at,qq={user_id}] Hi!")
loader.regEvent("message",message)
```

## æ³¨æ„äº‹é¡¹
- å½“å‰æ’ä»¶è°ƒç”¨å™¨å¹¶æœªä½¿ç”¨å¤šçº¿ç¨‹,å¦‚å“åº”æ…¢è¯·å•å¼€çº¿ç¨‹
- åŠ è½½æ’ä»¶ä¼˜å…ˆçº§æŒ‰ç…§A-zè¿›è¡ŒåŠ è½½ï¼Œåå­—è¶Šé å‰çš„æ’ä»¶è¶Šä¼˜å…ˆåŠ è½½
- *listen_event* äº‹ä»¶çš„ä¼˜å…ˆçº§é«˜äºå…¶ä»–äº‹ä»¶ï¼Œå“åº”äº‹ä»¶æ—¶ä¼šå…ˆå¤„ç†*listen_event*çš„æ’ä»¶ï¼Œç„¶åç»§ç»­å¤„ç†ä¸€èˆ¬äº‹ä»¶çš„æ’ä»¶